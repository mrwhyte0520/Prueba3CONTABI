{"version":3,"file":"page-KlNt2gbS.js","sources":["../../src/pages/accounting/periods/page.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../../../hooks/useAuth';\nimport { supabase } from '../../../lib/supabase';\nimport { useNavigate } from 'react-router-dom';\n\ninterface AccountingPeriod {\n  id: string;\n  name: string;\n  start_date: string;\n  end_date: string;\n  status: 'open' | 'closed' | 'locked';\n  fiscal_year: string;\n  created_at: string;\n  closed_at?: string;\n  closed_by?: string;\n  entries_count?: number;\n  total_debits?: number;\n  total_credits?: number;\n}\n\nconst AccountingPeriodsPage: React.FC = () => {\n  const { user } = useAuth();\n  const navigate = useNavigate();\n  const [periods, setPeriods] = useState<AccountingPeriod[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [showCreateModal, setShowCreateModal] = useState(false);\n  const [selectedPeriod, setSelectedPeriod] = useState<AccountingPeriod | null>(null);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [statusFilter, setStatusFilter] = useState('all');\n  const [yearFilter, setYearFilter] = useState('');\n\n  // Formulario para nuevo período\n  const [formData, setFormData] = useState({\n    name: '',\n    start_date: '',\n    end_date: '',\n    fiscal_year: new Date().getFullYear().toString()\n  });\n\n  useEffect(() => {\n    loadPeriods();\n  }, [user]);\n\n  const loadPeriods = async () => {\n    if (!user) return;\n    \n    try {\n      setLoading(true);\n      \n      // Intentar cargar desde Supabase\n      const { data: periodsData, error } = await supabase\n        .from('accounting_periods')\n        .select('*')\n        .eq('user_id', user.id)\n        .order('start_date', { ascending: false });\n\n      if (!error && periodsData) {\n        setPeriods(periodsData);\n      } else {\n        throw new Error('Error loading from Supabase');\n      }\n    } catch (error) {\n      console.error('Error loading periods:', error);\n      // Cargar datos de ejemplo\n      loadMockPeriods();\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const loadMockPeriods = () => {\n    setPeriods([]);\n  };\n\n  const downloadExcel = () => {\n    try {\n      // Crear contenido CSV\n      let csvContent = 'Períodos Contables\\n';\n      csvContent += `Generado: ${new Date().toLocaleDateString()}\\n\\n`;\n      csvContent += 'Período,Fecha Inicio,Fecha Fin,Año Fiscal,Estado,Asientos,Total Débitos,Total Créditos,Fecha Cierre,Cerrado Por\\n';\n      \n      filteredPeriods.forEach(period => {\n        const row = [\n          `\"${period.name}\"`,\n          new Date(period.start_date).toLocaleDateString(),\n          new Date(period.end_date).toLocaleDateString(),\n          period.fiscal_year,\n          period.status === 'open' ? 'Abierto' : period.status === 'closed' ? 'Cerrado' : 'Bloqueado',\n          period.entries_count || 0,\n          `RD$${(period.total_debits || 0).toLocaleString()}`,\n          `RD$${(period.total_credits || 0).toLocaleString()}`,\n          period.closed_at ? new Date(period.closed_at).toLocaleDateString() : '',\n          period.closed_by || ''\n        ].join(',');\n        csvContent += row + '\\n';\n      });\n\n      // Agregar resumen\n      csvContent += '\\nResumen:\\n';\n      csvContent += `Total Períodos:,${filteredPeriods.length}\\n`;\n      csvContent += `Períodos Abiertos:,${filteredPeriods.filter(p => p.status === 'open').length}\\n`;\n      csvContent += `Períodos Cerrados:,${filteredPeriods.filter(p => p.status === 'closed').length}\\n`;\n      csvContent += `Períodos Bloqueados:,${filteredPeriods.filter(p => p.status === 'locked').length}\\n`;\n      csvContent += `Total Asientos:,${filteredPeriods.reduce((sum, p) => sum + (p.entries_count || 0), 0)}\\n`;\n      csvContent += `Total Débitos:,RD$${filteredPeriods.reduce((sum, p) => sum + (p.total_debits || 0), 0).toLocaleString()}\\n`;\n      csvContent += `Total Créditos:,RD$${filteredPeriods.reduce((sum, p) => sum + (p.total_credits || 0), 0).toLocaleString()}\\n`;\n\n      // Crear y descargar archivo\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', `periodos_contables_${new Date().toISOString().split('T')[0]}.csv`);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    } catch (error) {\n      console.error('Error downloading Excel:', error);\n      alert('Error al descargar el archivo');\n    }\n  };\n\n  const validatePeriodDates = (startDate: string, endDate: string): string | null => {\n    if (!startDate || !endDate) {\n      return 'Debe especificar fecha de inicio y fin';\n    }\n\n    if (new Date(startDate) >= new Date(endDate)) {\n      return 'La fecha de inicio debe ser anterior a la fecha de fin';\n    }\n\n    // Verificar solapamiento con períodos existentes\n    const hasOverlap = periods.some(period => {\n      const periodStart = new Date(period.start_date);\n      const periodEnd = new Date(period.end_date);\n      const newStart = new Date(startDate);\n      const newEnd = new Date(endDate);\n\n      return (newStart <= periodEnd && newEnd >= periodStart);\n    });\n\n    if (hasOverlap) {\n      return 'El período se solapa con un período existente';\n    }\n\n    return null;\n  };\n\n  const handleCreatePeriod = async () => {\n    if (!user) return;\n\n    try {\n      // Validar fechas\n      const validationError = validatePeriodDates(formData.start_date, formData.end_date);\n      if (validationError) {\n        alert(validationError);\n        return;\n      }\n\n      if (!formData.name.trim()) {\n        alert('Debe especificar un nombre para el período');\n        return;\n      }\n\n      const newPeriod: AccountingPeriod = {\n        id: Date.now().toString(),\n        name: formData.name,\n        start_date: formData.start_date,\n        end_date: formData.end_date,\n        status: 'open',\n        fiscal_year: formData.fiscal_year,\n        created_at: new Date().toISOString(),\n        entries_count: 0,\n        total_debits: 0,\n        total_credits: 0\n      };\n\n      try {\n        const { data, error } = await supabase\n          .from('accounting_periods')\n          .insert([{\n            user_id: user.id,\n            name: newPeriod.name,\n            start_date: newPeriod.start_date,\n            end_date: newPeriod.end_date,\n            status: newPeriod.status,\n            fiscal_year: newPeriod.fiscal_year\n          }])\n          .select()\n          .single();\n\n        if (error) throw error;\n        \n        setPeriods(prev => [{ ...newPeriod, id: data.id }, ...prev]);\n      } catch (supabaseError) {\n        console.error('Supabase error:', supabaseError);\n        // Crear localmente si Supabase falla\n        setPeriods(prev => [newPeriod, ...prev]);\n      }\n      \n      // Resetear formulario\n      setFormData({\n        name: '',\n        start_date: '',\n        end_date: '',\n        fiscal_year: new Date().getFullYear().toString()\n      });\n      \n      setShowCreateModal(false);\n      alert('Período contable creado exitosamente');\n    } catch (error) {\n      console.error('Error creating period:', error);\n      alert('Error al crear el período contable');\n    }\n  };\n\n  const handleClosePeriod = async (periodId: string) => {\n    if (!confirm('¿Está seguro de que desea cerrar este período? Esta acción no se puede deshacer.')) {\n      return;\n    }\n\n    try {\n      const updatedPeriod = {\n        status: 'closed' as const,\n        closed_at: new Date().toISOString(),\n        closed_by: 'Admin'\n      };\n\n      try {\n        const { error } = await supabase\n          .from('accounting_periods')\n          .update(updatedPeriod)\n          .eq('id', periodId);\n\n        if (error) throw error;\n      } catch (supabaseError) {\n        console.error('Supabase error:', supabaseError);\n      }\n\n      setPeriods(prev => prev.map(period => \n        period.id === periodId \n          ? { ...period, ...updatedPeriod }\n          : period\n      ));\n      alert('Período cerrado exitosamente');\n    } catch (error) {\n      console.error('Error closing period:', error);\n      alert('Error al cerrar el período');\n    }\n  };\n\n  const handleLockPeriod = async (periodId: string) => {\n    if (!confirm('¿Está seguro de que desea bloquear este período? No se podrán realizar más cambios.')) {\n      return;\n    }\n\n    try {\n      const updatedPeriod = { status: 'locked' as const };\n\n      try {\n        const { error } = await supabase\n          .from('accounting_periods')\n          .update(updatedPeriod)\n          .eq('id', periodId);\n\n        if (error) throw error;\n      } catch (supabaseError) {\n        console.error('Supabase error:', supabaseError);\n      }\n\n      setPeriods(prev => prev.map(period => \n        period.id === periodId \n          ? { ...period, ...updatedPeriod }\n          : period\n      ));\n      alert('Período bloqueado exitosamente');\n    } catch (error) {\n      console.error('Error locking period:', error);\n      alert('Error al bloquear el período');\n    }\n  };\n\n  const handleReopenPeriod = async (periodId: string) => {\n    if (!confirm('¿Está seguro de que desea reabrir este período?')) {\n      return;\n    }\n\n    try {\n      const updatedPeriod = { \n        status: 'open' as const,\n        closed_at: undefined as unknown as string | undefined,\n        closed_by: undefined as unknown as string | undefined\n      };\n\n      try {\n        const { error } = await supabase\n          .from('accounting_periods')\n          .update(updatedPeriod)\n          .eq('id', periodId);\n\n        if (error) throw error;\n      } catch (supabaseError) {\n        console.error('Supabase error:', supabaseError);\n      }\n\n      setPeriods(prev => prev.map(period => \n        period.id === periodId \n          ? { ...period, ...updatedPeriod }\n          : period\n      ));\n      alert('Período reabierto exitosamente');\n    } catch (error) {\n      console.error('Error reopening period:', error);\n      alert('Error al reabrir el período');\n    }\n  };\n\n  const filteredPeriods = periods.filter(period => {\n    const matchesSearch = period.name.toLowerCase().includes(searchTerm.toLowerCase());\n    const matchesStatus = statusFilter === 'all' || period.status === statusFilter;\n    const matchesYear = !yearFilter || period.fiscal_year === yearFilter;\n    \n    return matchesSearch && matchesStatus && matchesYear;\n  });\n\n  const getStatusColor = (status: string) => {\n    switch (status) {\n      case 'open':\n        return 'bg-green-100 text-green-800';\n      case 'closed':\n        return 'bg-yellow-100 text-yellow-800';\n      case 'locked':\n        return 'bg-red-100 text-red-800';\n      default:\n        return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getStatusText = (status: string) => {\n    switch (status) {\n      case 'open':\n        return 'Abierto';\n      case 'closed':\n        return 'Cerrado';\n      case 'locked':\n        return 'Bloqueado';\n      default:\n        return 'Desconocido';\n    }\n  };\n\n  const uniqueYears = [...new Set(periods.map(p => p.fiscal_year))].sort().reverse();\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center min-h-screen\">\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"p-6 max-w-7xl mx-auto\">\n      {/* Header con botón de regreso */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div className=\"flex items-center gap-4\">\n          <button\n            onClick={() => navigate('/accounting')}\n            className=\"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors\"\n          >\n            <i className=\"ri-arrow-left-line\"></i>\n            Volver a Contabilidad\n          </button>\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Períodos Contables</h1>\n            <p className=\"text-gray-600\">Gestión de períodos fiscales</p>\n          </div>\n        </div>\n        <button\n          onClick={() => setShowCreateModal(true)}\n          className=\"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors\"\n        >\n          <i className=\"ri-add-line\"></i>\n          Nuevo Período\n        </button>\n      </div>\n\n      {/* Stats Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8\">\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"p-2 bg-green-100 rounded-lg\">\n              <i className=\"ri-calendar-check-line text-2xl text-green-600\"></i>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Períodos Abiertos</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {periods.filter(p => p.status === 'open').length}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"p-2 bg-yellow-100 rounded-lg\">\n              <i className=\"ri-calendar-close-line text-2xl text-yellow-600\"></i>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Períodos Cerrados</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {periods.filter(p => p.status === 'closed').length}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"p-2 bg-red-100 rounded-lg\">\n              <i className=\"ri-lock-line text-2xl text-red-600\"></i>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Períodos Bloqueados</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {periods.filter(p => p.status === 'locked').length}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"p-2 bg-blue-100 rounded-lg\">\n              <i className=\"ri-file-list-3-line text-2xl text-blue-600\"></i>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Total Asientos</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {periods.reduce((sum, p) => sum + (p.entries_count || 0), 0)}\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <div className=\"bg-white rounded-lg shadow p-6\">\n          <div className=\"flex items-center\">\n            <div className=\"p-2 bg-purple-100 rounded-lg\">\n              <i className=\"ri-calendar-line text-2xl text-purple-600\"></i>\n            </div>\n            <div className=\"ml-4\">\n              <p className=\"text-sm font-medium text-gray-600\">Año Fiscal Actual</p>\n              <p className=\"text-2xl font-bold text-gray-900\">\n                {new Date().getFullYear()}\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Filters and Actions */}\n      <div className=\"bg-white rounded-lg shadow mb-6\">\n        <div className=\"p-6 border-b border-gray-200\">\n          <div className=\"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4\">\n            <div className=\"flex flex-col sm:flex-row gap-4\">\n              <div className=\"relative\">\n                <i className=\"ri-search-line absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400\"></i>\n                <input\n                  type=\"text\"\n                  placeholder=\"Buscar períodos...\"\n                  value={searchTerm}\n                  onChange={(e) => setSearchTerm(e.target.value)}\n                  className=\"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                />\n              </div>\n              \n              <select\n                value={statusFilter}\n                onChange={(e) => setStatusFilter(e.target.value)}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n              >\n                <option value=\"all\">Todos los estados</option>\n                <option value=\"open\">Abiertos</option>\n                <option value=\"closed\">Cerrados</option>\n                <option value=\"locked\">Bloqueados</option>\n              </select>\n              \n              <select\n                value={yearFilter}\n                onChange={(e) => setYearFilter(e.target.value)}\n                className=\"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent pr-8\"\n              >\n                <option value=\"\">Todos los años</option>\n                {uniqueYears.map(year => (\n                  <option key={year} value={year}>{year}</option>\n                ))}\n              </select>\n            </div>\n          </div>\n        </div>\n\n        {/* Periods Table */}\n        <div className=\"overflow-x-auto\">\n          <table className=\"min-w-full divide-y divide-gray-200\">\n            <thead className=\"bg-gray-50\">\n              <tr>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Período\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Fecha Inicio\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Fecha Fin\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Año Fiscal\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Estado\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Asientos\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Total Movimientos\n                </th>\n                <th className=\"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider\">\n                  Acciones\n                </th>\n              </tr>\n            </thead>\n            <tbody className=\"bg-white divide-y divide-gray-200\">\n              {filteredPeriods.map((period) => (\n                <tr key={period.id} className=\"hover:bg-gray-50\">\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900\">\n                    {period.name}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {new Date(period.start_date).toLocaleDateString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-500\">\n                    {new Date(period.end_date).toLocaleDateString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {period.fiscal_year}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap\">\n                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(period.status)}`}>\n                      {getStatusText(period.status)}\n                    </span>\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    {period.entries_count || 0}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm text-gray-900\">\n                    RD${((period.total_debits || 0) + (period.total_credits || 0)).toLocaleString()}\n                  </td>\n                  <td className=\"px-6 py-4 whitespace-nowrap text-sm font-medium\">\n                    <div className=\"flex space-x-2\">\n                      <button\n                        onClick={() => setSelectedPeriod(period)}\n                        className=\"text-blue-600 hover:text-blue-900\"\n                        title=\"Ver detalles\"\n                      >\n                        <i className=\"ri-eye-line\"></i>\n                      </button>\n                      \n                      {period.status === 'open' && (\n                        <button\n                          onClick={() => handleClosePeriod(period.id)}\n                          className=\"text-yellow-600 hover:text-yellow-900\"\n                          title=\"Cerrar período\"\n                        >\n                          <i className=\"ri-calendar-close-line\"></i>\n                        </button>\n                      )}\n                      \n                      {period.status === 'closed' && (\n                        <>\n                          <button\n                            onClick={() => handleLockPeriod(period.id)}\n                            className=\"text-red-600 hover:text-red-900\"\n                            title=\"Bloquear período\"\n                          >\n                            <i className=\"ri-lock-line\"></i>\n                          </button>\n                          <button\n                            onClick={() => handleReopenPeriod(period.id)}\n                            className=\"text-green-600 hover:text-green-900\"\n                            title=\"Reabrir período\"\n                          >\n                            <i className=\"ri-calendar-check-line\"></i>\n                          </button>\n                        </>\n                      )}\n                    </div>\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </div>\n\n      {/* Create Period Modal */}\n      {showCreateModal && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-md w-full mx-4\">\n            <div className=\"p-6 border-b border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <h2 className=\"text-xl font-semibold text-gray-900\">Nuevo Período Contable</h2>\n                <button\n                  onClick={() => setShowCreateModal(false)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <i className=\"ri-close-line text-2xl\"></i>\n                </button>\n              </div>\n            </div>\n\n            <div className=\"p-6\">\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Nombre del Período\n                  </label>\n                  <input\n                    type=\"text\"\n                    value={formData.name}\n                    onChange={(e) => setFormData(prev => ({ ...prev, name: e.target.value }))}\n                    placeholder=\"Ej: Enero 2025\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Fecha de Inicio\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={formData.start_date}\n                    onChange={(e) => setFormData(prev => ({ ...prev, start_date: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Fecha de Fin\n                  </label>\n                  <input\n                    type=\"date\"\n                    value={formData.end_date}\n                    onChange={(e) => setFormData(prev => ({ ...prev, end_date: e.target.value }))}\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n                \n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Año Fiscal\n                  </label>\n                  <input\n                    type=\"number\"\n                    value={formData.fiscal_year}\n                    onChange={(e) => setFormData(prev => ({ ...prev, fiscal_year: e.target.value }))}\n                    min=\"2020\"\n                    max=\"2030\"\n                    className=\"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                  />\n                </div>\n              </div>\n\n              <div className=\"flex justify-end space-x-4 mt-6\">\n                <button\n                  onClick={() => setShowCreateModal(false)}\n                  className=\"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={handleCreatePeriod}\n                  disabled={!formData.name || !formData.start_date || !formData.end_date}\n                  className=\"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors\"\n                >\n                  Crear Período\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {/* Period Detail Modal */}\n      {selectedPeriod && (\n        <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n          <div className=\"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4\">\n            <div className=\"p-6 border-b border-gray-200\">\n              <div className=\"flex items-center justify-between\">\n                <h2 className=\"text-xl font-semibold text-gray-900\">\n                  Detalles del Período: {selectedPeriod.name}\n                </h2>\n                <button\n                  onClick={() => setSelectedPeriod(null)}\n                  className=\"text-gray-400 hover:text-gray-600\"\n                >\n                  <i className=\"ri-close-line text-2xl\"></i>\n                </button>\n              </div>\n            </div>\n\n            <div className=\"p-6\">\n              <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n                <div>\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Información General</h3>\n                  <div className=\"space-y-3\">\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Período:</span>\n                      <span className=\"ml-2 text-sm text-gray-900\">{selectedPeriod.name}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Fecha Inicio:</span>\n                      <span className=\"ml-2 text-sm text-gray-900\">\n                        {new Date(selectedPeriod.start_date).toLocaleDateString()}\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Fecha Fin:</span>\n                      <span className=\"ml-2 text-sm text-gray-900\">\n                        {new Date(selectedPeriod.end_date).toLocaleDateString()}\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Año Fiscal:</span>\n                      <span className=\"ml-2 text-sm text-gray-900\">{selectedPeriod.fiscal_year}</span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Estado:</span>\n                      <span className={`ml-2 inline-flex px-2 py-1 text-xs font-semibold rounded-full ${getStatusColor(selectedPeriod.status)}`}>\n                        {getStatusText(selectedPeriod.status)}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                <div>\n                  <h3 className=\"text-lg font-medium text-gray-900 mb-4\">Estadísticas del Período</h3>\n                  <div className=\"space-y-3\">\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Total Asientos:</span>\n                      <span className=\"ml-2 text-sm font-bold text-gray-900\">\n                        {selectedPeriod.entries_count || 0}\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Total Débitos:</span>\n                      <span className=\"ml-2 text-sm font-bold text-green-600\">\n                        RD${(selectedPeriod.total_debits || 0).toLocaleString()}\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Total Créditos:</span>\n                      <span className=\"ml-2 text-sm font-bold text-red-600\">\n                        RD${(selectedPeriod.total_credits || 0).toLocaleString()}\n                      </span>\n                    </div>\n                    <div>\n                      <span className=\"text-sm font-medium text-gray-500\">Creado:</span>\n                      <span className=\"ml-2 text-sm text-gray-900\">\n                        {new Date(selectedPeriod.created_at).toLocaleDateString()}\n                      </span>\n                    </div>\n                    {selectedPeriod.closed_at && (\n                      <>\n                        <div>\n                          <span className=\"text-sm font-medium text-gray-500\">Cerrado:</span>\n                          <span className=\"ml-2 text-sm text-gray-900\">\n                            {new Date(selectedPeriod.closed_at).toLocaleDateString()}\n                          </span>\n                        </div>\n                        <div>\n                          <span className=\"text-sm font-medium text-gray-500\">Cerrado por:</span>\n                          <span className=\"ml-2 text-sm text-gray-900\">{selectedPeriod.closed_by}</span>\n                        </div>\n                      </>\n                    )}\n                  </div>\n                </div>\n              </div>\n\n              {/* Actions */}\n              <div className=\"mt-8 pt-6 border-t border-gray-200\">\n                <div className=\"flex justify-between\">\n                  <div className=\"space-x-2\">\n                    {selectedPeriod.status === 'open' && (\n                      <button\n                        onClick={() => {\n                          handleClosePeriod(selectedPeriod.id);\n                          setSelectedPeriod(null);\n                        }}\n                        className=\"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors\"\n                      >\n                        <i className=\"ri-calendar-close-line mr-2\"></i>\n                        Cerrar Período\n                      </button>\n                    )}\n                    \n                    {selectedPeriod.status === 'closed' && (\n                      <>\n                        <button\n                          onClick={() => {\n                            handleLockPeriod(selectedPeriod.id);\n                            setSelectedPeriod(null);\n                          }}\n                          className=\"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors\"\n                        >\n                          <i className=\"ri-lock-line mr-2\"></i>\n                          Bloquear Período\n                        </button>\n                        <button\n                          onClick={() => {\n                            handleReopenPeriod(selectedPeriod.id);\n                            setSelectedPeriod(null);\n                          }}\n                          className=\"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors\"\n                        >\n                          <i className=\"ri-calendar-check-line mr-2\"></i>\n                          Reabrir Período\n                        </button>\n                      </>\n                    )}\n                  </div>\n                  \n                  <button\n                    onClick={() => setSelectedPeriod(null)}\n                    className=\"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors\"\n                  >\n                    Cerrar\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default AccountingPeriodsPage;\n"],"names":["AccountingPeriodsPage","user","useAuth","navigate","useNavigate","periods","setPeriods","useState","loading","setLoading","showCreateModal","setShowCreateModal","selectedPeriod","setSelectedPeriod","searchTerm","setSearchTerm","statusFilter","setStatusFilter","yearFilter","setYearFilter","formData","setFormData","useEffect","loadPeriods","periodsData","error","supabase","loadMockPeriods","validatePeriodDates","startDate","endDate","period","periodStart","periodEnd","newStart","newEnd","handleCreatePeriod","validationError","newPeriod","data","prev","supabaseError","handleClosePeriod","periodId","updatedPeriod","handleLockPeriod","handleReopenPeriod","filteredPeriods","matchesSearch","matchesStatus","matchesYear","getStatusColor","status","getStatusText","uniqueYears","p","jsx","jsxs","sum","e","year","Fragment"],"mappings":"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"}