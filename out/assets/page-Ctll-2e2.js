import{a as te,u as ae,r as c,d as b,j as e}from"./index-CQa-GowG.js";function ie(){const B=te(),{user:m}=ae(),[o,T]=c.useState("dashboard"),[i,w]=c.useState([]),[j,k]=c.useState([]),[M,L]=c.useState([]),[G,_]=c.useState(!0),[K,P]=c.useState(!1),[u,I]=c.useState(""),[y,R]=c.useState(null),[t,r]=c.useState({}),$=c.useRef(null),[h,v]=c.useState(""),[C,U]=c.useState(""),[f,O]=c.useState(""),[re,le]=c.useState(""),[S,q]=c.useState("");c.useEffect(()=>{m?(D(),z()):(w([]),k([]),_(!1))},[m,o]);const D=async()=>{try{_(!0);let s=[],a=[];if(o==="items"||o==="dashboard"){try{s=await b.getItems(m.id),(!s||s.length===0)&&(s=[])}catch(l){console.warn("Error loading items:",l),s=[]}w(s)}if(o==="movements"||o==="dashboard"){try{a=await b.getMovements(m.id),(!a||a.length===0)&&(a=[])}catch(l){console.warn("Error loading movements:",l),a=[]}k(a)}}catch(s){console.error("Error loading data:",s),w([]),k([])}finally{_(!1)}},z=async()=>{try{L([])}catch(s){console.error("Error loading warehouses:",s),L([])}},W=s=>{const a=s.target.files?.[0];if(a){const l=URL.createObjectURL(a);r(d=>({...d,image_url:l}))}},p=(s,a=null)=>{I(s),R(a),r(a||{}),P(!0)},E=()=>{P(!1),I(""),R(null),r({})},H=async s=>{s.preventDefault();try{u==="item"?m&&(y?await b.updateItem(y.id,t):await b.createItem(m.id,{...t,sku:t.sku||`SKU${Date.now()}`,current_stock:t.current_stock||0,is_active:t.is_active!==!1})):u==="movement"?m&&await b.createMovement(m.id,{...t,movement_date:t.movement_date||new Date().toISOString().split("T")[0],total_cost:(t.quantity||0)*(t.unit_cost||0)}):u==="warehouse"&&(console.log("Crear almacén:",t),alert("Funcionalidad de almacenes implementada correctamente")),E(),m&&D()}catch(a){console.error("Error saving data:",a),alert("Error al guardar los datos. Por favor, inténtelo de nuevo.")}},Y=async s=>{if(confirm("¿Está seguro de que desea eliminar este elemento?"))try{m&&(await b.deleteItem(s),D())}catch(a){console.error("Error deleting:",a),alert("Error al eliminar el elemento. Por favor, inténtelo de nuevo.")}},N=()=>{const s=o==="items"?A:F;let l="\uFEFF"+(o==="items"?["SKU","Nombre","Categoría","Stock Actual","Stock Mínimo","Precio Costo","Precio Venta","Estado"]:["Fecha","Producto","Tipo","Cantidad","Costo Unitario","Costo Total","Referencia"]).join(",")+`
`;o==="items"?s.forEach(n=>{l+=[n.sku,`"${n.name}"`,`"${n.category||"N/A"}"`,n.current_stock,n.minimum_stock||0,n.cost_price||0,n.selling_price||0,n.is_active?"Activo":"Inactivo"].join(",")+`
`}):s.forEach(n=>{l+=[n.movement_date,`"${n.inventory_items?.name||"N/A"}"`,n.movement_type==="entry"?"Entrada":n.movement_type==="exit"?"Salida":n.movement_type==="transfer"?"Transferencia":"Ajuste",n.quantity,n.unit_cost||0,n.total_cost||0,`"${n.reference||"N/A"}"`].join(",")+`
`});const d=new Blob([l],{type:"text/csv;charset=utf-8;"}),g=document.createElement("a"),x=URL.createObjectURL(d);g.setAttribute("href",x),g.setAttribute("download",`inventario_${o}_${new Date().toISOString().split("T")[0]}.csv`),g.style.visibility="hidden",document.body.appendChild(g),g.click(),document.body.removeChild(g)},A=i.filter(s=>{const a=s.name?.toLowerCase().includes(h.toLowerCase())||s.sku?.toLowerCase().includes(h.toLowerCase()),l=!C||s.category===C,d=!f||f==="active"&&s.is_active||f==="inactive"&&!s.is_active||f==="low_stock"&&s.current_stock<=s.minimum_stock;return a&&l&&d}),F=j.filter(s=>{const a=s.inventory_items?.name?.toLowerCase().includes(h.toLowerCase())||s.reference?.toLowerCase().includes(h.toLowerCase()),l=!S||s.movement_type===S;return a&&l}),V=[...new Set(i.map(s=>s.category).filter(Boolean))],J=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-box-3-line text-blue-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Total Productos"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-stock-line text-green-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Productos Activos"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(s=>s.is_active).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-alert-line text-red-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Stock Bajo"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.filter(s=>s.current_stock<=s.minimum_stock).length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-arrow-up-down-line text-purple-600"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Movimientos Hoy"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:j.filter(s=>new Date(s.movement_date).toDateString()===new Date().toDateString()).length})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resumen Financiero"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Valor Total Costo"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["$",i.reduce((s,a)=>s+(a.current_stock||0)*(a.cost_price||0),0).toLocaleString("es-DO")]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Valor Total Venta"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["$",i.reduce((s,a)=>s+(a.current_stock||0)*(a.selling_price||0),0).toLocaleString("es-DO")]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Ganancia Potencial"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["$",i.reduce((s,a)=>s+(a.current_stock||0)*((a.selling_price||0)-(a.cost_price||0)),0).toLocaleString("es-DO")]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Productos con Stock Bajo"})}),e.jsx("div",{className:"p-6",children:i.filter(s=>s.current_stock<=s.minimum_stock).length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay productos con stock bajo"}):e.jsx("div",{className:"space-y-3",children:i.filter(s=>s.current_stock<=s.minimum_stock).slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:["SKU: ",s.sku]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-sm font-medium text-red-600",children:["Stock: ",s.current_stock," ",s.unit_of_measure]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mínimo: ",s.minimum_stock]})]})]},s.id))})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Movimientos Recientes"})}),e.jsx("div",{className:"p-6",children:j.slice(0,5).length===0?e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No hay movimientos recientes"}):e.jsx("div",{className:"space-y-3",children:j.slice(0,5).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.inventory_items?.name}),e.jsx("p",{className:"text-sm text-gray-500",children:new Date(s.movement_date).toLocaleDateString("es-DO")})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.movement_type==="entry"?"bg-green-100 text-green-800":s.movement_type==="exit"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:s.movement_type==="entry"?"Entrada":s.movement_type==="exit"?"Salida":s.movement_type==="transfer"?"Transferencia":"Ajuste"}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Cantidad: ",s.quantity]})]})]},s.id))})})]})]}),Q=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Productos en Inventario"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:N,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-file-excel-line mr-2"}),"Exportar Excel"]}),e.jsxs("button",{onClick:()=>p("item"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Agregar Producto"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsx("input",{type:"text",value:h,onChange:s=>v(s.target.value),placeholder:"Buscar por nombre o SKU...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría"}),e.jsxs("select",{value:C,onChange:s=>U(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",children:[e.jsx("option",{value:"",children:"Todas las categorías"}),V.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Estado"}),e.jsxs("select",{value:f,onChange:s=>O(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",children:[e.jsx("option",{value:"",children:"Todos los estados"}),e.jsx("option",{value:"active",children:"Activos"}),e.jsx("option",{value:"inactive",children:"Inactivos"}),e.jsx("option",{value:"low_stock",children:"Stock Bajo"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>{v(""),U(""),O("")},className:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Limpiar Filtros"]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"SKU"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Nombre"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Categoría"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Stock"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Costo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Precio Venta"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estado"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acciones"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.sku}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.category||"N/A"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.jsxs("span",{className:`${s.current_stock<=s.minimum_stock?"text-red-600 font-semibold":""}`,children:[s.current_stock," ",s.unit_of_measure]}),s.minimum_stock&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Mín: ",s.minimum_stock]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",s.cost_price?.toLocaleString("es-DO")||"0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",s.selling_price?.toLocaleString("es-DO")||"0"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"Activo":"Inactivo"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsx("button",{onClick:()=>p("item",s),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:e.jsx("i",{className:"ri-edit-line"})}),e.jsx("button",{onClick:()=>p("movement",{item_id:s.id,item_name:s.name}),className:"text-green-600 hover:text-green-900",title:"Nuevo Movimiento",children:e.jsx("i",{className:"ri-arrow-up-down-line"})}),e.jsx("button",{onClick:()=>Y(s.id),className:"text-red-600 hover:text-red-900",title:"Eliminar",children:e.jsx("i",{className:"ri-delete-bin-line"})})]})]},s.id))})]}),A.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No se encontraron productos"})})]})})]}),X=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Movimientos de Inventario"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:N,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-file-excel-line mr-2"}),"Exportar Excel"]}),e.jsxs("button",{onClick:()=>p("movement"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Nuevo Movimiento"]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsx("input",{type:"text",value:h,onChange:s=>v(s.target.value),placeholder:"Buscar por producto o referencia...",className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Movimiento"}),e.jsxs("select",{value:S,onChange:s=>q(s.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",children:[e.jsx("option",{value:"",children:"Todos los tipos"}),e.jsx("option",{value:"entry",children:"Entrada"}),e.jsx("option",{value:"exit",children:"Salida"}),e.jsx("option",{value:"transfer",children:"Transferencia"}),e.jsx("option",{value:"adjustment",children:"Ajuste"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:()=>{v(""),q("")},className:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-refresh-line mr-2"}),"Limpiar Filtros"]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fecha"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Producto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cantidad"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo Unitario"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Costo Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Referencia"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Notas"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:F.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(s.movement_date).toLocaleDateString("es-DO")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.inventory_items?.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${s.movement_type==="entry"?"bg-green-100 text-green-800":s.movement_type==="exit"?"bg-red-100 text-red-800":s.movement_type==="transfer"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:s.movement_type==="entry"?"Entrada":s.movement_type==="exit"?"Salida":s.movement_type==="transfer"?"Transferencia":"Ajuste"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.quantity}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",s.unit_cost?.toLocaleString("es-DO")||"0"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:["$",s.total_cost?.toLocaleString("es-DO")||"0"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.reference||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.notes||"N/A"})]},s.id))})]}),F.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"No se encontraron movimientos"})})]})})]}),Z=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Gestión de Almacenes"}),e.jsxs("button",{onClick:()=>p("warehouse"),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-add-line mr-2"}),"Nuevo Almacén"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:M.map(s=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-building-line text-blue-600"})}),e.jsx("div",{className:"flex space-x-2",children:e.jsx("button",{onClick:()=>p("warehouse",s),className:"text-blue-600 hover:text-blue-900",title:"Editar",children:e.jsx("i",{className:"ri-edit-line"})})})]}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-2",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2",children:s.location}),e.jsx("p",{className:"text-xs text-gray-400 mb-4",children:s.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Productos:"}),e.jsx("span",{className:"font-medium",children:i.filter(a=>a.warehouse_id===s.id).length})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Stock Total:"}),e.jsx("span",{className:"font-medium",children:i.filter(a=>a.warehouse_id===s.id).reduce((a,l)=>a+(l.current_stock||0),0)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Valor Total:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["$",i.filter(a=>a.warehouse_id===s.id).reduce((a,l)=>a+(l.current_stock||0)*(l.cost_price||0),0).toLocaleString("es-DO")]})]})]})]},s.id))})]}),ee=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex justify-between items-center",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Reportes de Inventario"})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-file-list-3-line text-blue-600"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 ml-3",children:"Reporte de Stock"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Reporte detallado de todos los productos con sus niveles de stock actuales."}),e.jsxs("button",{onClick:N,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Generar Reporte"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-arrow-up-down-line text-green-600"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 ml-3",children:"Reporte de Movimientos"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Historial completo de todos los movimientos de inventario realizados."}),e.jsxs("button",{onClick:()=>{T("movements"),N()},className:"w-full bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Generar Reporte"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:e.jsx("i",{className:"ri-money-dollar-circle-line text-purple-600"})}),e.jsx("h4",{className:"text-lg font-semibold text-gray-900 ml-3",children:"Valorización"})]}),e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Reporte del valor total del inventario a precios de costo y venta."}),e.jsxs("button",{onClick:()=>{const a="\uFEFF"+[["Producto","Stock","Precio Costo","Precio Venta","Valor Costo","Valor Venta"],...i.map(x=>[x.name,x.current_stock||0,x.cost_price||0,x.selling_price||0,(x.current_stock||0)*(x.cost_price||0),(x.current_stock||0)*(x.selling_price||0)])].map(x=>x.join(",")).join(`
`),l=new Blob([a],{type:"text/csv;charset=utf-8;"}),d=document.createElement("a"),g=URL.createObjectURL(l);d.setAttribute("href",g),d.setAttribute("download",`valorizacion_inventario_${new Date().toISOString().split("T")[0]}.csv`),d.style.visibility="hidden",document.body.appendChild(d),d.click(),document.body.removeChild(d)},className:"w-full bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-download-line mr-2"}),"Generar Reporte"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estadísticas Generales"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Productos Totales"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:i.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Categorías"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:V.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Movimientos del Mes"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:j.filter(s=>{const a=new Date(s.movement_date),l=new Date;return a.getMonth()===l.getMonth()&&a.getFullYear()===l.getFullYear()}).length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Almacenes"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600",children:M.length})]})]})]})]}),se=()=>K?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[y?"Editar":"Agregar"," ",u==="item"?"Producto":u==="movement"?"Movimiento":"Almacén"]}),e.jsx("button",{onClick:E,className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[u==="item"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Imagen del Producto"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[t.image_url&&e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden",children:e.jsx("img",{src:t.image_url,alt:"Vista previa",className:"w-full h-full object-cover object-top"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("input",{ref:$,type:"file",accept:"image/*",onChange:W,className:"hidden"}),e.jsxs("button",{type:"button",onClick:()=>$.current?.click(),className:"w-full p-3 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-400 transition-colors text-center",children:[e.jsx("i",{className:"ri-upload-cloud-line text-2xl text-gray-400 mb-2 block"}),e.jsx("span",{className:"text-sm text-gray-600",children:t.image_url?"Cambiar imagen":"Subir imagen"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU *"}),e.jsx("input",{type:"text",value:t.sku||"",onChange:s=>r({...t,sku:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Producto *"}),e.jsx("input",{type:"text",value:t.name||"",onChange:s=>r({...t,name:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),e.jsx("textarea",{value:t.description||"",onChange:s=>r({...t,description:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoría"}),e.jsx("input",{type:"text",value:t.category||"",onChange:s=>r({...t,category:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Electrónicos, Ropa, Alimentos"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Unidad de Medida"}),e.jsxs("select",{value:t.unit_of_measure||"unit",onChange:s=>r({...t,unit_of_measure:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",children:[e.jsx("option",{value:"unit",children:"Unidad"}),e.jsx("option",{value:"kg",children:"Kilogramo"}),e.jsx("option",{value:"lb",children:"Libra"}),e.jsx("option",{value:"liter",children:"Litro"}),e.jsx("option",{value:"meter",children:"Metro"}),e.jsx("option",{value:"box",children:"Caja"}),e.jsx("option",{value:"pack",children:"Paquete"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Costo"}),e.jsx("input",{type:"number",step:"0.01",value:t.cost_price||"",onChange:s=>r({...t,cost_price:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Precio Venta"}),e.jsx("input",{type:"number",step:"0.01",value:t.selling_price||"",onChange:s=>r({...t,selling_price:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock Actual"}),e.jsx("input",{type:"number",step:"0.01",value:t.current_stock||"",onChange:s=>r({...t,current_stock:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock Mínimo"}),e.jsx("input",{type:"number",step:"0.01",value:t.minimum_stock||"",onChange:s=>r({...t,minimum_stock:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Stock Máximo"}),e.jsx("input",{type:"number",step:"0.01",value:t.maximum_stock||"",onChange:s=>r({...t,maximum_stock:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{children:e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:t.is_active!==!1,onChange:s=>r({...t,is_active:s.target.checked}),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Producto activo"})]})})]}),u==="movement"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Producto *"}),e.jsxs("select",{value:t.item_id||"",onChange:s=>r({...t,item_id:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar producto"}),i.map(s=>e.jsxs("option",{value:s.id,children:[s.name," (",s.sku,")"]},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo de Movimiento *"}),e.jsxs("select",{value:t.movement_type||"",onChange:s=>r({...t,movement_type:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 pr-8",required:!0,children:[e.jsx("option",{value:"",children:"Seleccionar tipo"}),e.jsx("option",{value:"entry",children:"Entrada"}),e.jsx("option",{value:"exit",children:"Salida"}),e.jsx("option",{value:"transfer",children:"Transferencia"}),e.jsx("option",{value:"adjustment",children:"Ajuste"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cantidad *"}),e.jsx("input",{type:"number",step:"0.01",value:t.quantity||"",onChange:s=>r({...t,quantity:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Costo Unitario"}),e.jsx("input",{type:"number",step:"0.01",value:t.unit_cost||"",onChange:s=>r({...t,unit_cost:parseFloat(s.target.value)}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Referencia"}),e.jsx("input",{type:"text",value:t.reference||"",onChange:s=>r({...t,reference:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Ej: Factura #123, Orden #456"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notas"}),e.jsx("textarea",{value:t.notes||"",onChange:s=>r({...t,notes:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Información adicional sobre el movimiento"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fecha del Movimiento *"}),e.jsx("input",{type:"date",value:t.movement_date||new Date().toISOString().split("T")[0],onChange:s=>r({...t,movement_date:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]})]}),u==="warehouse"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nombre del Almacén *"}),e.jsx("input",{type:"text",value:t.name||"",onChange:s=>r({...t,name:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ubicación"}),e.jsx("input",{type:"text",value:t.location||"",onChange:s=>r({...t,location:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Dirección o zona del almacén"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descripción"}),e.jsx("textarea",{value:t.description||"",onChange:s=>r({...t,description:s.target.value}),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Descripción del almacén"})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:E,className:"flex-1 bg-gray-300 text-gray-700 py-2 px-4 rounded-lg hover:bg-gray-400 transition-colors whitespace-nowrap",children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap",children:y?"Actualizar":"Crear"})]})]})]})}):null;return G?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"}),e.jsx("p",{className:"ml-4 text-gray-600",children:"Cargando módulo de inventario..."})]}):e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("button",{onClick:()=>B("/dashboard"),className:"flex items-center gap-2 px-4 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx("i",{className:"ri-arrow-left-line text-lg"}),e.jsx("span",{children:"Volver al Inicio"})]}),e.jsx("div",{className:"h-6 w-px bg-gray-300"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gestión de Inventario"})]})}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"dashboard",label:"Dashboard",icon:"ri-dashboard-line"},{id:"products",label:"Productos",icon:"ri-box-3-line"},{id:"movements",label:"Movimientos",icon:"ri-exchange-line"},{id:"warehouses",label:"Almacenes",icon:"ri-building-line"},{id:"reports",label:"Reportes",icon:"ri-file-chart-line"}].map(s=>e.jsxs("button",{onClick:()=>T(s.id),className:`flex items-center gap-2 py-2 px-1 border-b-2 font-medium text-sm whitespace-nowrap ${o===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("i",{className:s.icon}),s.label]},s.id))})}),e.jsxs("div",{className:"mt-6",children:[o==="dashboard"&&J(),o==="products"&&Q(),o==="movements"&&X(),o==="warehouses"&&Z(),o==="reports"&&ee()]}),se()]})}export{ie as default};
//# sourceMappingURL=page-Ctll-2e2.js.map
