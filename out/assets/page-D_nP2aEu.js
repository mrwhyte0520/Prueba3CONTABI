import{u as N,a as w,r as i,s as p,j as e,D as g}from"./index-CQa-GowG.js";function P(){const{user:o}=N(),u=w(),[f,b]=i.useState(!1),[c,d]=i.useState(!1),[m,t]=i.useState(null),[a,n]=i.useState({email:o?.email||"",fullName:"",phone:"",company:"",position:"",address:"",city:"",country:"República Dominicana"}),[l,x]=i.useState({currentPassword:"",newPassword:"",confirmPassword:""});i.useEffect(()=>{if(!o){u("/login");return}h()},[o,u]);const h=async()=>{try{b(!0);const{data:s,error:r}=await p.from("users").select("*").eq("id",o?.id).single();if(r)throw r;s&&n({email:s.email||o?.email||"",fullName:s.full_name||"",phone:s.phone||"",company:s.company||"",position:s.position||"",address:s.address||"",city:s.city||"",country:s.country||"República Dominicana"})}catch(s){console.error("Error al cargar perfil:",s)}finally{b(!1)}},y=async s=>{s.preventDefault(),d(!0),t(null);try{const{error:r}=await p.from("users").update({full_name:a.fullName,phone:a.phone,company:a.company,position:a.position,address:a.address,city:a.city,country:a.country,updated_at:new Date().toISOString()}).eq("id",o?.id);if(r)throw r;t({type:"success",text:"Perfil actualizado correctamente"}),setTimeout(()=>t(null),3e3)}catch(r){t({type:"error",text:r.message||"Error al actualizar perfil"})}finally{d(!1)}},j=async s=>{if(s.preventDefault(),l.newPassword!==l.confirmPassword){t({type:"error",text:"Las contraseñas no coinciden"});return}if(l.newPassword.length<6){t({type:"error",text:"La contraseña debe tener al menos 6 caracteres"});return}d(!0),t(null);try{const{error:r}=await p.auth.updateUser({password:l.newPassword});if(r)throw r;t({type:"success",text:"Contraseña actualizada correctamente"}),x({currentPassword:"",newPassword:"",confirmPassword:""}),setTimeout(()=>t(null),3e3)}catch(r){t({type:"error",text:r.message||"Error al cambiar contraseña"})}finally{d(!1)}};return f?e.jsx(g,{children:e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"ri-loader-4-line text-4xl text-blue-600 animate-spin"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Cargando perfil..."})]})})}):e.jsx(g,{children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Mi Perfil"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Administra tu información personal y configuración de cuenta"})]}),m&&e.jsxs("div",{className:`mb-6 p-4 rounded-lg flex items-center ${m.type==="success"?"bg-green-50 text-green-800 border border-green-200":"bg-red-50 text-red-800 border border-red-200"}`,children:[e.jsx("i",{className:`${m.type==="success"?"ri-check-line":"ri-error-warning-line"} text-xl mr-3`}),e.jsx("span",{children:m.text})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 shadow-lg mb-4",children:e.jsx("span",{className:"text-3xl font-bold text-white",children:a.fullName?.charAt(0).toUpperCase()||o?.email?.charAt(0).toUpperCase()||"U"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a.fullName||"Usuario"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a.email}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-center text-sm text-gray-600",children:[e.jsx("i",{className:"ri-vip-crown-line text-yellow-500 mr-2"}),e.jsx("span",{className:"font-medium",children:"Plan Básico"})]}),e.jsx("button",{onClick:()=>u("/plans"),className:"mt-3 w-full px-4 py-2 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 text-sm font-medium",children:"Mejorar Plan"})]})]})}),e.jsxs("div",{className:"mt-6 bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Estadísticas"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Facturas emitidas"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Clientes activos"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"0"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Productos"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:"0"})]})]})]})]}),e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("i",{className:"ri-user-line text-2xl text-blue-600 mr-3"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Información Personal"})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nombre Completo"}),e.jsx("input",{type:"text",value:a.fullName,onChange:s=>n({...a,fullName:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Juan Pérez"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Correo Electrónico"}),e.jsx("input",{type:"email",value:a.email,disabled:!0,className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Teléfono"}),e.jsx("input",{type:"tel",value:a.phone,onChange:s=>n({...a,phone:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"(809) 555-5555"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Empresa"}),e.jsx("input",{type:"text",value:a.company,onChange:s=>n({...a,company:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Mi Empresa S.A."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cargo"}),e.jsx("input",{type:"text",value:a.position,onChange:s=>n({...a,position:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Contador"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ciudad"}),e.jsx("input",{type:"text",value:a.city,onChange:s=>n({...a,city:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Santo Domingo"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Dirección"}),e.jsx("input",{type:"text",value:a.address,onChange:s=>n({...a,address:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Calle Principal #123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"País"}),e.jsx("input",{type:"text",value:a.country,onChange:s=>n({...a,country:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:c,className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:c?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Guardando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-save-line mr-2"}),"Guardar Cambios"]})})})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("i",{className:"ri-lock-password-line text-2xl text-blue-600 mr-3"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Cambiar Contraseña"})]}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nueva Contraseña"}),e.jsx("input",{type:"password",value:l.newPassword,onChange:s=>x({...l,newPassword:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Mínimo 6 caracteres"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Nueva Contraseña"}),e.jsx("input",{type:"password",value:l.confirmPassword,onChange:s=>x({...l,confirmPassword:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Repite la contraseña"})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsx("button",{type:"submit",disabled:c||!l.newPassword||!l.confirmPassword,className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-blue-700 text-white rounded-lg hover:from-blue-700 hover:to-blue-800 transition-all duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center whitespace-nowrap",children:c?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-loader-4-line animate-spin mr-2"}),"Actualizando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"ri-key-line mr-2"}),"Cambiar Contraseña"]})})})]})]})]})]})]})})}export{P as default};
//# sourceMappingURL=page-D_nP2aEu.js.map
