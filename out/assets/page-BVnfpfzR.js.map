{"version":3,"file":"page-BVnfpfzR.js","sources":["../../src/pages/accounting/chart-accounts/page.tsx"],"sourcesContent":["import { useState, useRef, useEffect } from 'react';\nimport DashboardLayout from '../../../components/layout/DashboardLayout';\nimport { chartAccountsService } from '../../../services/database';\nimport { useAuth } from '../../../hooks/useAuth';\n\ninterface ChartAccount {\n  id: string;\n  code: string;\n  name: string;\n  type: 'asset' | 'liability' | 'equity' | 'income' | 'expense';\n  parentId?: string;\n  level: number;\n  balance: number;\n  isActive: boolean;\n  description?: string;\n  normalBalance: 'debit' | 'credit';\n  allowPosting: boolean;\n  createdAt: string;\n  updatedAt: string;\n}\n\ninterface ImportData {\n  code: string;\n  name: string;\n  type: string;\n  parentCode?: string;\n  description?: string;\n  balance?: number;\n  category?: string;\n  subCategory?: string;\n}\n\ninterface ImportFormat {\n  id: string;\n  name: string;\n  description: string;\n  fileTypes: string[];\n  icon: string;\n  color: string;\n}\n\nexport default function ChartAccountsPage() {\n  const { user } = useAuth();\n  const [accounts, setAccounts] = useState<ChartAccount[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [searchTerm, setSearchTerm] = useState('');\n  const [selectedAccountType, setSelectedAccountType] = useState('all');\n  const [showAddModal, setShowAddModal] = useState(false);\n  const [showEditModal, setShowEditModal] = useState(false);\n  const [showImportModal, setShowImportModal] = useState(false);\n  const [showFormatModal, setShowFormatModal] = useState(false);\n  const [selectedFormat, setSelectedFormat] = useState<ImportFormat | null>(null);\n  const [editingAccount, setEditingAccount] = useState<ChartAccount | null>(null);\n  const [expandedAccounts, setExpandedAccounts] = useState<string[]>([]);\n  const [importProgress, setImportProgress] = useState(0);\n  const [isImporting, setIsImporting] = useState(false);\n  const fileInputRef = useRef<HTMLInputElement>(null);\n\n  const [newAccount, setNewAccount] = useState({\n    code: '',\n    name: '',\n    type: 'asset' as const,\n    parentId: '',\n    description: '',\n    allowPosting: true\n  });\n\n  // Load accounts from database\n  useEffect(() => {\n    if (user) {\n      loadAccounts();\n    }\n  }, [user]);\n\n  const loadAccounts = async () => {\n    if (!user) return;\n    \n    setLoading(true);\n    try {\n      const data = await chartAccountsService.getAll(user.id);\n      setAccounts(data);\n    } catch (error) {\n      console.error('Error loading accounts:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const importFormats: ImportFormat[] = [\n    {\n      id: 'csv',\n      name: 'CSV Estándar',\n      description: 'Formato CSV compatible con Excel y sistemas contables básicos',\n      fileTypes: ['.csv'],\n      icon: 'ri-file-text-line',\n      color: 'bg-green-100 text-green-800'\n    },\n    {\n      id: 'quickbooks',\n      name: 'QuickBooks',\n      description: 'Formato IIF de QuickBooks Desktop y Online',\n      fileTypes: ['.iif', '.qbx', '.csv'],\n      icon: 'ri-file-chart-line',\n      color: 'bg-blue-100 text-blue-800'\n    },\n    {\n      id: 'excel',\n      name: 'Microsoft Excel',\n      description: 'Archivos Excel con formato estructurado (.xlsx, .xls)',\n      fileTypes: ['.xlsx', '.xls'],\n      icon: 'ri-file-excel-line',\n      color: 'bg-green-100 text-green-800'\n    },\n    {\n      id: 'sage',\n      name: 'Sage 50/100/200',\n      description: 'Formato de exportación de Sage Accounting',\n      fileTypes: ['.csv', '.txt'],\n      icon: 'ri-file-list-line',\n      color: 'bg-purple-100 text-purple-800'\n    },\n    {\n      id: 'sap',\n      name: 'SAP Business One',\n      description: 'Formato XML/CSV de SAP para plan de cuentas',\n      fileTypes: ['.xml', '.csv'],\n      icon: 'ri-file-code-line',\n      color: 'bg-orange-100 text-orange-800'\n    },\n    {\n      id: 'xero',\n      name: 'Xero Accounting',\n      description: 'Formato CSV de Xero para importación de cuentas',\n      fileTypes: ['.csv'],\n      icon: 'ri-cloud-line',\n      color: 'bg-indigo-100 text-indigo-800'\n    },\n    {\n      id: 'json',\n      name: 'JSON Universal',\n      description: 'Formato JSON para sistemas modernos y APIs',\n      fileTypes: ['.json'],\n      icon: 'ri-code-s-slash-line',\n      color: 'bg-gray-100 text-gray-800'\n    },\n    {\n      id: 'xml',\n      name: 'XML Estándar',\n      description: 'Formato XML compatible con múltiples sistemas ERP',\n      fileTypes: ['.xml'],\n      icon: 'ri-file-code-line',\n      color: 'bg-yellow-100 text-yellow-800'\n    }\n  ];\n\n  const accountTypes = [\n    { value: 'all', label: 'Todos los Tipos' },\n    { value: 'asset', label: 'Activos' },\n    { value: 'liability', label: 'Pasivos' },\n    { value: 'equity', label: 'Patrimonio' },\n    { value: 'income', label: 'Ingresos' },\n    { value: 'expense', label: 'Gastos' }\n  ];\n\n  const filteredAccounts = accounts.filter(account => {\n    const matchesSearch = account.name.toLowerCase().includes(searchTerm.toLowerCase()) ||\n                         account.code.includes(searchTerm);\n    const matchesType = selectedAccountType === 'all' || account.type === selectedAccountType;\n    return matchesSearch && matchesType;\n  });\n\n  const getAccountTypeColor = (type: string) => {\n    switch (type) {\n      case 'asset': return 'bg-blue-100 text-blue-800';\n      case 'liability': return 'bg-red-100 text-red-800';\n      case 'equity': return 'bg-green-100 text-green-800';\n      case 'income': return 'bg-purple-100 text-purple-800';\n      case 'expense': return 'bg-orange-100 text-orange-800';\n      default: return 'bg-gray-100 text-gray-800';\n    }\n  };\n\n  const getAccountTypeName = (type: string) => {\n    switch (type) {\n      case 'asset': return 'Activo';\n      case 'liability': return 'Pasivo';\n      case 'equity': return 'Patrimonio';\n      case 'income': return 'Ingreso';\n      case 'expense': return 'Gasto';\n      default: return 'Otro';\n    }\n  };\n\n  const getNormalBalance = (type: string): 'debit' | 'credit' => {\n    return ['asset', 'expense'].includes(type) ? 'debit' : 'credit';\n  };\n\n  const getParentAccounts = (type: string) => {\n    return accounts.filter(account => \n      account.type === type && \n      account.level < 4 && \n      !account.allowPosting\n    );\n  };\n\n  const calculateLevel = (parentId: string): number => {\n    if (!parentId) return 1;\n    const parent = accounts.find(acc => acc.id === parentId);\n    return parent ? parent.level + 1 : 1;\n  };\n\n  const toggleExpanded = (accountId: string) => {\n    setExpandedAccounts(prev =>\n      prev.includes(accountId)\n        ? prev.filter(id => id !== accountId)\n        : [...prev, accountId]\n    );\n  };\n\n  const getChildAccounts = (parentId: string) => {\n    return filteredAccounts.filter(account => account.parentId === parentId);\n  };\n\n  const handleFormatSelection = (format: ImportFormat) => {\n    setSelectedFormat(format);\n    setShowFormatModal(false);\n    setShowImportModal(true);\n  };\n\n  const parseCSVContent = (content: string): ImportData[] => {\n    const lines = content.split('\\n');\n    const importedData: ImportData[] = [];\n\n    for (let i = 1; i < lines.length; i++) {\n      const line = lines[i].trim();\n      if (!line) continue;\n\n      const columns = line.split(',').map(col => col.trim().replace(/\"/g, ''));\n      if (columns.length >= 3) {\n        importedData.push({\n          code: columns[0],\n          name: columns[1],\n          type: columns[2].toLowerCase(),\n          parentCode: columns[3] || undefined,\n          description: columns[4] || undefined,\n          balance: columns[5] ? parseFloat(columns[5]) : 0\n        });\n      }\n    }\n\n    return importedData;\n  };\n\n  const parseQuickBooksIIF = (content: string): ImportData[] => {\n    const lines = content.split('\\n');\n    const importedData: ImportData[] = [];\n\n    for (const line of lines) {\n      if (line.startsWith('ACCNT')) {\n        const parts = line.split('\\t');\n        if (parts.length >= 4) {\n          const accountType = parts[2]?.toLowerCase();\n          const mappedType = mapQuickBooksType(accountType);\n          \n          importedData.push({\n            code: parts[1] || '',\n            name: parts[1] || '',\n            type: mappedType,\n            description: parts[3] || '',\n            balance: parts[4] ? parseFloat(parts[4]) : 0\n          });\n        }\n      }\n    }\n\n    return importedData;\n  };\n\n  const parseExcelData = async (file: File): Promise<ImportData[]> => {\n    const text = await file.text();\n    return parseCSVContent(text);\n  };\n\n  const parseXMLContent = (content: string): ImportData[] => {\n    const parser = new DOMParser();\n    const xmlDoc = parser.parseFromString(content, 'text/xml');\n    const accounts = xmlDoc.getElementsByTagName('account');\n    const importedData: ImportData[] = [];\n\n    for (let i = 0; i < accounts.length; i++) {\n      const account = accounts[i];\n      const code = account.getAttribute('code') || '';\n      const name = account.getAttribute('name') || account.textContent || '';\n      const type = account.getAttribute('type')?.toLowerCase() || 'asset';\n      const parentCode = account.getAttribute('parent') || undefined;\n      const description = account.getAttribute('description') || undefined;\n\n      importedData.push({\n        code,\n        name,\n        type,\n        parentCode,\n        description\n      });\n    }\n\n    return importedData;\n  };\n\n  const parseJSONContent = (content: string): ImportData[] => {\n    try {\n      const data = JSON.parse(content);\n      if (Array.isArray(data)) {\n        return data.map(item => ({\n          code: item.code || item.accountCode || '',\n          name: item.name || item.accountName || '',\n          type: (item.type || item.accountType || 'asset').toLowerCase(),\n          parentCode: item.parentCode || item.parent || undefined,\n          description: item.description || undefined,\n          balance: item.balance || 0\n        }));\n      }\n    } catch (error) {\n      console.error('Error parsing JSON:', error);\n    }\n    return [];\n  };\n\n  const mapQuickBooksType = (qbType: string): string => {\n    const typeMap: { [key: string]: string } = {\n      'bank': 'asset',\n      'accounts receivable': 'asset',\n      'other current asset': 'asset',\n      'fixed asset': 'asset',\n      'accounts payable': 'liability',\n      'credit card': 'liability',\n      'other current liability': 'liability',\n      'long term liability': 'liability',\n      'equity': 'equity',\n      'income': 'income',\n      'expense': 'expense',\n      'cost of goods sold': 'expense'\n    };\n    \n    return typeMap[qbType] || 'asset';\n  };\n\n  const mapSageType = (sageType: string): string => {\n    const typeMap: { [key: string]: string } = {\n      'nominal': 'expense',\n      'bank': 'asset',\n      'customer': 'asset',\n      'supplier': 'liability',\n      'asset': 'asset',\n      'liability': 'liability',\n      'capital': 'equity',\n      'sales': 'income',\n      'purchase': 'expense'\n    };\n    \n    return typeMap[sageType.toLowerCase()] || 'asset';\n  };\n\n  const handleFileImport = async (event: React.ChangeEvent<HTMLInputElement>) => {\n    const file = event.target.files?.[0];\n    if (!file || !selectedFormat || !user) return;\n\n    setIsImporting(true);\n    setImportProgress(0);\n\n    try {\n      let importedData: ImportData[] = [];\n      const fileExtension = file.name.toLowerCase().split('.').pop();\n\n      setImportProgress(25);\n\n      switch (selectedFormat.id) {\n        case 'csv':\n        case 'sage':\n        case 'xero':\n          const csvContent = await file.text();\n          importedData = parseCSVContent(csvContent);\n          break;\n\n        case 'quickbooks':\n          if (fileExtension === 'iif') {\n            const iifContent = await file.text();\n            importedData = parseQuickBooksIIF(iifContent);\n          } else {\n            const csvContent = await file.text();\n            importedData = parseCSVContent(csvContent);\n          }\n          break;\n\n        case 'excel':\n          importedData = await parseExcelData(file);\n          break;\n\n        case 'xml':\n        case 'sap':\n          const xmlContent = await file.text();\n          importedData = parseXMLContent(xmlContent);\n          break;\n\n        case 'json':\n          const jsonContent = await file.text();\n          importedData = parseJSONContent(jsonContent);\n          break;\n\n        default:\n          throw new Error('Formato no soportado');\n      }\n\n      setImportProgress(75);\n\n      await processImportedData(importedData);\n      \n      setImportProgress(100);\n      setTimeout(() => {\n        setIsImporting(false);\n        setImportProgress(0);\n        setShowImportModal(false);\n        alert(`Se importaron ${importedData.length} cuentas exitosamente desde ${selectedFormat.name}.`);\n      }, 500);\n\n    } catch (error) {\n      setIsImporting(false);\n      setImportProgress(0);\n      alert(`Error al procesar el archivo ${selectedFormat.name}. Verifique el formato.`);\n      console.error('Import error:', error);\n    }\n  };\n\n  const processImportedData = async (importedData: ImportData[]) => {\n    if (!user) return;\n\n    const codeToIdMap: { [key: string]: string } = {};\n\n    for (const data of importedData) {\n      if (!data.code || !data.name) continue;\n\n      try {\n        const account = {\n          code: data.code,\n          name: data.name,\n          type: data.type as any || 'asset',\n          level: 1,\n          balance: data.balance || 0,\n          is_active: true,\n          description: data.description,\n          normal_balance: getNormalBalance(data.type || 'asset'),\n          allow_posting: true,\n          parent_id: null\n        };\n\n        const createdAccount = await chartAccountsService.create(user.id, account);\n        codeToIdMap[data.code] = createdAccount.id;\n      } catch (error) {\n        console.error('Error importing account:', data.code, error);\n      }\n    }\n\n    await loadAccounts();\n  };\n\n  const downloadTemplate = (formatId: string) => {\n    let template = '';\n    let filename = '';\n\n    switch (formatId) {\n      case 'csv':\n        template = `Código,Nombre,Tipo,Código Padre,Descripción,Saldo\n1000,ACTIVOS,asset,,Activos totales de la empresa,0\n1100,ACTIVOS CORRIENTES,asset,1000,Activos de corto plazo,0\n1110,Efectivo y Equivalentes,asset,1100,Dinero en efectivo y equivalentes,0\n1111,Caja General,asset,1110,Dinero en caja,25000\n2000,PASIVOS,liability,,Pasivos totales de la empresa,0\n2100,PASIVOS CORRIENTES,liability,2000,Pasivos de corto plazo,0\n3000,PATRIMONIO,equity,,Patrimonio de la empresa,0\n4000,INGRESOS,income,,Ingresos totales,0\n5000,GASTOS,expense,,Gastos totales,0`;\n        filename = 'plantilla_catalogo_cuentas.csv';\n        break;\n\n      case 'quickbooks':\n        template = `!ACCNT\tNAME\tACCNTTYPE\tDESC\tACCNUM\nACCNT\tCaja General\tBank\tCuenta de caja principal\t1111\nACCNT\tBanco Popular\tBank\tCuenta bancaria principal\t1112\nACCNT\tCuentas por Cobrar\tAccounts Receivable\tCuentas por cobrar clientes\t1120\nACCNT\tInventarios\tOther Current Asset\tInventario de productos\t1130\nACCNT\tCuentas por Pagar\tAccounts Payable\tCuentas por pagar proveedores\t2110\nACCNT\tCapital Social\tEquity\tCapital social de la empresa\t3100\nACCNT\tVentas\tIncome\tIngresos por ventas\t4100\nACCNT\tGastos Operativos\tExpense\tGastos operativos generales\t5100`;\n        filename = 'plantilla_quickbooks.iif';\n        break;\n\n      case 'xml':\n        template = `<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<chart_of_accounts>\n  <account code=\"1000\" name=\"ACTIVOS\" type=\"asset\" description=\"Activos totales\"/>\n  <account code=\"1100\" name=\"ACTIVOS CORRIENTES\" type=\"asset\" parent=\"1000\" description=\"Activos corrientes\"/>\n  <account code=\"1111\" name=\"Caja General\" type=\"asset\" parent=\"1100\" description=\"Caja principal\"/>\n  <account code=\"2000\" name=\"PASIVOS\" type=\"liability\" description=\"Pasivos totales\"/>\n  <account code=\"2110\" name=\"Cuentas por Pagar\" type=\"liability\" parent=\"2000\" description=\"Cuentas por pagar\"/>\n  <account code=\"3000\" name=\"PATRIMONIO\" type=\"equity\" description=\"Patrimonio total\"/>\n  <account code=\"4000\" name=\"INGRESOS\" type=\"income\" description=\"Ingresos totales\"/>\n  <account code=\"5000\" name=\"GASTOS\" type=\"expense\" description=\"Gastos totales\"/>\n</chart_of_accounts>`;\n        filename = 'plantilla_catalogo.xml';\n        break;\n\n      case 'json':\n        template = JSON.stringify([\n          { code: \"1000\", name: \"ACTIVOS\", type: \"asset\", description: \"Activos totales\" },\n          { code: \"1100\", name: \"ACTIVOS CORRIENTES\", type: \"asset\", parentCode: \"1000\", description: \"Activos corrientes\" },\n          { code: \"1111\", name: \"Caja General\", type: \"asset\", parentCode: \"1100\", description: \"Caja principal\", balance: 25000 },\n          { code: \"2000\", name: \"PASIVOS\", type: \"liability\", description: \"Pasivos totales\" },\n          { code: \"2110\", name: \"Cuentas por Pagar\", type: \"liability\", parentCode: \"2000\", description: \"Cuentas por pagar\" },\n          { code: \"3000\", name: \"PATRIMONIO\", type: \"equity\", description: \"Patrimonio total\" },\n          { code: \"4000\", name: \"INGRESOS\", type: \"income\", description: \"Ingresos totales\" },\n          { code: \"5000\", name: \"GASTOS\", type: \"expense\", description: \"Gastos totales\" }\n        ], null, 2);\n        filename = 'plantilla_catalogo.json';\n        break;\n\n      default:\n        return;\n    }\n\n    const blob = new Blob([template], { type: 'text/plain' });\n    const url = window.URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = filename;\n    a.click();\n    window.URL.revokeObjectURL(url);\n  };\n\n  const handleAddAccount = async () => {\n    if (!user || !newAccount.code || !newAccount.name) {\n      alert('Por favor complete todos los campos requeridos.');\n      return;\n    }\n\n    try {\n      const account = {\n        code: newAccount.code,\n        name: newAccount.name,\n        type: newAccount.type,\n        parent_id: newAccount.parentId || null,\n        level: calculateLevel(newAccount.parentId),\n        balance: 0,\n        is_active: true,\n        description: newAccount.description,\n        normal_balance: getNormalBalance(newAccount.type),\n        allow_posting: newAccount.allowPosting\n      };\n\n      await chartAccountsService.create(user.id, account);\n      await loadAccounts();\n      \n      setNewAccount({\n        code: '',\n        name: '',\n        type: 'asset',\n        parentId: '',\n        description: '',\n        allowPosting: true\n      });\n      setShowAddModal(false);\n      alert('Cuenta creada exitosamente.');\n    } catch (error) {\n      console.error('Error creating account:', error);\n      alert('Error al crear la cuenta. Verifique que el código no esté duplicado.');\n    }\n  };\n\n  const handleEditAccount = async () => {\n    if (!editingAccount || !editingAccount.code || !editingAccount.name) {\n      alert('Por favor complete todos los campos requeridos.');\n      return;\n    }\n\n    try {\n      const account = {\n        code: editingAccount.code,\n        name: editingAccount.name,\n        description: editingAccount.description,\n        allow_posting: editingAccount.allowPosting,\n        is_active: editingAccount.isActive\n      };\n\n      await chartAccountsService.update(editingAccount.id, account);\n      await loadAccounts();\n      \n      setEditingAccount(null);\n      setShowEditModal(false);\n      alert('Cuenta actualizada exitosamente.');\n    } catch (error) {\n      console.error('Error updating account:', error);\n      alert('Error al actualizar la cuenta.');\n    }\n  };\n\n  const handleDeleteAccount = async (accountId: string) => {\n    if (!confirm('¿Está seguro de que desea eliminar esta cuenta? Esta acción no se puede deshacer.')) {\n      return;\n    }\n\n    try {\n      // Verificar si la cuenta tiene movimientos\n      const account = accounts.find(acc => acc.id === accountId);\n      if (account && account.balance !== 0) {\n        alert('No se puede eliminar una cuenta con saldo. Primero debe transferir el saldo a otra cuenta.');\n        return;\n      }\n\n      // Verificar si tiene cuentas hijas\n      const hasChildren = accounts.some(acc => acc.parentId === accountId);\n      if (hasChildren) {\n        alert('No se puede eliminar una cuenta que tiene subcuentas. Primero elimine o reasigne las subcuentas.');\n        return;\n      }\n\n      await chartAccountsService.delete(accountId);\n      await loadAccounts();\n      alert('Cuenta eliminada exitosamente.');\n    } catch (error) {\n      console.error('Error deleting account:', error);\n      alert('Error al eliminar la cuenta. Verifique que no tenga movimientos contables asociados.');\n    }\n  };\n\n  const downloadExcel = () => {\n    try {\n      // Crear contenido CSV\n      let csvContent = 'Catálogo de Cuentas\\n';\n      csvContent += `Generado: ${new Date().toLocaleDateString()}\\n\\n`;\n      csvContent += 'Código,Nombre,Tipo,Nivel,Saldo,Estado,Descripción\\n';\n      \n      filteredAccounts.forEach(account => {\n        const row = [\n          account.code,\n          `\"${account.name}\"`,\n          getAccountTypeName(account.type),\n          account.level,\n          Math.abs(account.balance).toLocaleString(),\n          account.isActive ? 'Activa' : 'Inactiva',\n          `\"${account.description || ''}\"`\n        ].join(',');\n        csvContent += row + '\\n';\n      });\n\n      // Agregar resumen por tipo\n      csvContent += '\\nResumen por Tipo:\\n';\n      const accountsByType = filteredAccounts.reduce((acc, account) => {\n        acc[account.type] = (acc[account.type] || 0) + 1;\n        return acc;\n      }, {} as Record<string, number>);\n\n      Object.entries(accountsByType).forEach(([type, count]) => {\n        csvContent += `${getAccountTypeName(type)},${count}\\n`;\n      });\n\n      // Crear y descargar archivo\n      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });\n      const link = document.createElement('a');\n      const url = URL.createObjectURL(blob);\n      link.setAttribute('href', url);\n      link.setAttribute('download', `catalogo_cuentas_${new Date().toISOString().split('T')[0]}.csv`);\n      link.style.visibility = 'hidden';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    } catch (error) {\n      console.error('Error downloading Excel:', error);\n      alert('Error al descargar el archivo');\n    }\n  };\n\n  const renderAccountRow = (account: ChartAccount) => {\n    const hasChildren = accounts.some(acc => acc.parentId === account.id);\n    const isExpanded = expandedAccounts.includes(account.id);\n    const children = getChildAccounts(account.id);\n\n    return (\n      <div key={account.id}>\n        <div className=\"flex items-center py-3 px-4 border-b border-gray-100 hover:bg-gray-50\">\n          <div className=\"flex items-center flex-1\" style={{ paddingLeft: `${(account.level - 1) * 20}px` }}>\n            {hasChildren && (\n              <button\n                onClick={() => toggleExpanded(account.id)}\n                className=\"mr-2 text-gray-400 hover:text-gray-600\"\n              >\n                <i className={`ri-arrow-${isExpanded ? 'down' : 'right'}-s-line`}></i>\n              </button>\n            )}\n            <div className=\"flex-1 grid grid-cols-7 gap-4 items-center\">\n              <div className=\"font-medium text-gray-900\">{account.code}</div>\n              <div className=\"text-gray-900\">{account.name}</div>\n              <div>\n                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${getAccountTypeColor(account.type)}`}>\n                  {getAccountTypeName(account.type)}\n                </span>\n              </div>\n              <div className=\"text-sm text-gray-600\">{account.level}</div>\n              <div className=\"text-sm text-gray-900\">\n                RD${Math.abs(account.balance).toLocaleString()}\n                {account.balance < 0 && ' (Cr)'}\n              </div>\n              <div>\n                <span className={`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${\n                  account.isActive ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'\n                }`}>\n                  {account.isActive ? 'Activa' : 'Inactiva'}\n                </span>\n              </div>\n              <div className=\"flex space-x-2\">\n                <button\n                  onClick={() => {\n                    setEditingAccount(account);\n                    setShowEditModal(true);\n                  }}\n                  className=\"text-blue-600 hover:text-blue-900\"\n                >\n                  <i className=\"ri-edit-line\"></i>\n                </button>\n                <button\n                  onClick={() => handleDeleteAccount(account.id)}\n                  className=\"text-red-600 hover:text-red-900\"\n                >\n                  <i className=\"ri-delete-bin-line\"></i>\n                </button>\n              </div>\n            </div>\n          </div>\n        </div>\n        {hasChildren && isExpanded && children.map(child => renderAccountRow(child))}\n      </div>\n    );\n  };\n\n  const topLevelAccounts = filteredAccounts.filter(account => account.level === 1);\n\n  if (loading) {\n    return (\n      <DashboardLayout>\n        <div className=\"p-6 flex items-center justify-center\">\n          <div className=\"text-center\">\n            <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto\"></div>\n            <p className=\"mt-4 text-gray-600\">Cargando catálogo de cuentas...</p>\n          </div>\n        </div>\n      </DashboardLayout>\n    );\n  }\n\n  return (\n    <DashboardLayout>\n      <div className=\"p-6\">\n        <div className=\"flex justify-between items-center mb-6\">\n          <div>\n            <h1 className=\"text-2xl font-bold text-gray-900\">Catálogo de Cuentas</h1>\n            <p className=\"text-gray-600 mt-1\">Gestión completa del plan de cuentas contables</p>\n          </div>\n          <div className=\"flex space-x-3\">\n            <button\n              onClick={downloadExcel}\n              className=\"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap\"\n            >\n              <i className=\"ri-file-excel-line mr-2\"></i>\n              Descargar Excel\n            </button>\n            <button\n              onClick={() => setShowFormatModal(true)}\n              className=\"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors whitespace-nowrap\"\n            >\n              <i className=\"ri-upload-line mr-2\"></i>\n              Importar Catálogo\n            </button>\n            <button\n              onClick={() => setShowAddModal(true)}\n              className=\"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors whitespace-nowrap\"\n            >\n              <i className=\"ri-add-line mr-2\"></i>\n              Nueva Cuenta\n            </button>\n          </div>\n        </div>\n\n        {/* Filters */}\n        <div className=\"flex flex-col md:flex-row gap-4 mb-6\">\n          <div className=\"flex-1\">\n            <div className=\"relative\">\n              <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\n                <i className=\"ri-search-line text-gray-400\"></i>\n              </div>\n              <input\n                type=\"text\"\n                value={searchTerm}\n                onChange={(e) => setSearchTerm(e.target.value)}\n                className=\"block w-full pl-10 pr-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm\"\n                placeholder=\"Buscar cuentas por código o nombre...\"\n              />\n            </div>\n          </div>\n          <div className=\"w-full md:w-48\">\n            <select\n              value={selectedAccountType}\n              onChange={(e) => setSelectedAccountType(e.target.value)}\n              className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm pr-8\"\n            >\n              {accountTypes.map((type) => (\n                <option key={type.value} value={type.value}>{type.label}</option>\n              ))}\n            </select>\n          </div>\n        </div>\n\n        {/* Chart of Accounts */}\n        <div className=\"bg-white rounded-lg shadow-sm border border-gray-200\">\n          <div className=\"px-4 py-3 border-b border-gray-200 bg-gray-50\">\n            <div className=\"grid grid-cols-7 gap-4 text-xs font-medium text-gray-500 uppercase tracking-wider\">\n              <div>Código</div>\n              <div>Nombre de la Cuenta</div>\n              <div>Tipo</div>\n              <div>Nivel</div>\n              <div>Saldo</div>\n              <div>Estado</div>\n              <div>Acciones</div>\n            </div>\n          </div>\n          <div className=\"max-h-96 overflow-y-auto\">\n            {topLevelAccounts.length === 0 ? (\n              <div className=\"p-8 text-center text-gray-500\">\n                <i className=\"ri-file-list-line text-4xl mb-4 block\"></i>\n                <p className=\"text-lg font-medium mb-2\">No hay cuentas registradas</p>\n                <p className=\"text-sm\">Comience agregando su primera cuenta contable o importe un catálogo existente.</p>\n              </div>\n            ) : (\n              topLevelAccounts.map(account => renderAccountRow(account))\n            )}\n          </div>\n        </div>\n\n        {/* Format Selection Modal */}\n        {showFormatModal && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-lg p-6 w-full max-w-4xl max-h-[80vh] overflow-y-auto\">\n              <h3 className=\"text-lg font-semibold mb-4\">Seleccionar Formato de Importación</h3>\n              <p className=\"text-gray-600 mb-6\">Elija el formato del sistema contable desde el cual desea importar el catálogo de cuentas:</p>\n              \n              <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6\">\n                {importFormats.map((format) => (\n                  <div\n                    key={format.id}\n                    onClick={() => handleFormatSelection(format)}\n                    className=\"border border-gray-200 rounded-lg p-4 hover:border-blue-500 hover:shadow-md transition-all cursor-pointer\"\n                  >\n                    <div className=\"flex items-center mb-2\">\n                      <div className={`w-10 h-10 rounded-lg ${format.color} flex items-center justify-center mr-3`}>\n                        <i className={`${format.icon} text-lg`}></i>\n                      </div>\n                      <div>\n                        <h4 className=\"font-medium\">{format.name}</h4>\n                        <p className=\"text-xs text-gray-500\">{format.fileTypes.join(', ')}</p>\n                      </div>\n                    </div>\n                    <p className=\"text-sm text-gray-600\">{format.description}</p>\n                  </div>\n                ))}\n              </div>\n\n              <div className=\"flex justify-end\">\n                <button\n                  onClick={() => setShowFormatModal(false)}\n                  className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 whitespace-nowrap\"\n                >\n                  Cancelar\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Import Modal */}\n        {showImportModal && selectedFormat && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-lg p-6 w-full max-w-lg\">\n              <h3 className=\"text-lg font-semibold mb-4\">Importar desde {selectedFormat.name}</h3>\n              \n              <div className=\"space-y-4\">\n                <div className={`border rounded-lg p-4 ${selectedFormat.color.replace('text-', 'border-').replace('100', '200')}`}>\n                  <div className=\"flex items-center mb-2\">\n                    <i className={`${selectedFormat.icon} text-lg mr-2`}></i>\n                    <h4 className=\"font-medium\">{selectedFormat.name}</h4>\n                  </div>\n                  <p className=\"text-sm mb-2\">{selectedFormat.description}</p>\n                  <p className=\"text-xs\">Formatos soportados: {selectedFormat.fileTypes.join(', ')}</p>\n                </div>\n                \n                <div>\n                  <button\n                    onClick={() => downloadTemplate(selectedFormat.id)}\n                    className=\"w-full bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 transition-colors whitespace-nowrap mb-4\"\n                  >\n                    <i className=\"ri-download-line mr-2\"></i>\n                    Descargar Plantilla {selectedFormat.name}\n                  </button>\n                </div>\n\n                {isImporting && (\n                  <div className=\"mb-4\">\n                    <div className=\"flex justify-between text-sm text-gray-600 mb-1\">\n                      <span>Procesando archivo...</span>\n                      <span>{importProgress}%</span>\n                    </div>\n                    <div className=\"w-full bg-gray-200 rounded-full h-2\">\n                      <div \n                        className=\"bg-blue-600 h-2 rounded-full transition-all duration-300\"\n                        style={{ width: `${importProgress}%` }}\n                      ></div>\n                    </div>\n                  </div>\n                )}\n\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                    Seleccionar archivo {selectedFormat.name}\n                  </label>\n                  <input\n                    ref={fileInputRef}\n                    type=\"file\"\n                    accept={selectedFormat.fileTypes.join(',')}\n                    onChange={handleFileImport}\n                    disabled={isImporting}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  />\n                </div>\n              </div>\n              \n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => {\n                    setShowImportModal(false);\n                    setSelectedFormat(null);\n                  }}\n                  disabled={isImporting}\n                  className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 whitespace-nowrap disabled:opacity-50\"\n                >\n                  Cancelar\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Add Account Modal */}\n        {showAddModal && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\n              <h3 className=\"text-lg font-semibold mb-4\">Agregar Nueva Cuenta</h3>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Código</label>\n                  <input\n                    type=\"text\"\n                    value={newAccount.code}\n                    onChange={(e) => setNewAccount({...newAccount, code: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    placeholder=\"Ej: 1114\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nombre</label>\n                  <input\n                    type=\"text\"\n                    value={newAccount.name}\n                    onChange={(e) => setNewAccount({...newAccount, name: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    placeholder=\"Nombre de la cuenta\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Tipo</label>\n                  <select\n                    value={newAccount.type}\n                    onChange={(e) => setNewAccount({...newAccount, type: e.target.value as any})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-8\"\n                  >\n                    <option value=\"asset\">Activo</option>\n                    <option value=\"liability\">Pasivo</option>\n                    <option value=\"equity\">Patrimonio</option>\n                    <option value=\"income\">Ingreso</option>\n                    <option value=\"expense\">Gasto</option>\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Cuenta Padre</label>\n                  <select\n                    value={newAccount.parentId}\n                    onChange={(e) => setNewAccount({...newAccount, parentId: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 pr-8\"\n                  >\n                    <option value=\"\">Cuenta Principal</option>\n                    {getParentAccounts(newAccount.type).map(account => (\n                      <option key={account.id} value={account.id}>\n                        {account.code} - {account.name}\n                      </option>\n                    ))}\n                  </select>\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Descripción</label>\n                  <textarea\n                    value={newAccount.description}\n                    onChange={(e) => setNewAccount({...newAccount, description: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    rows={3}\n                    placeholder=\"Descripción opcional\"\n                  />\n                </div>\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"allowPosting\"\n                    checked={newAccount.allowPosting}\n                    onChange={(e) => setNewAccount({...newAccount, allowPosting: e.target.checked})}\n                    className=\"mr-2\"\n                  />\n                  <label htmlFor=\"allowPosting\" className=\"text-sm text-gray-700\">\n                    Permitir movimientos contables\n                  </label>\n                </div>\n              </div>\n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => setShowAddModal(false)}\n                  className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 whitespace-nowrap\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={handleAddAccount}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 whitespace-nowrap\"\n                >\n                  Agregar Cuenta\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n\n        {/* Edit Account Modal */}\n        {showEditModal && editingAccount && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50\">\n            <div className=\"bg-white rounded-lg p-6 w-full max-w-md\">\n              <h3 className=\"text-lg font-semibold mb-4\">Editar Cuenta</h3>\n              <div className=\"space-y-4\">\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Código</label>\n                  <input\n                    type=\"text\"\n                    value={editingAccount.code}\n                    onChange={(e) => setEditingAccount({...editingAccount, code: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Nombre</label>\n                  <input\n                    type=\"text\"\n                    value={editingAccount.name}\n                    onChange={(e) => setEditingAccount({...editingAccount, name: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                  />\n                </div>\n                <div>\n                  <label className=\"block text-sm font-medium text-gray-700 mb-1\">Descripción</label>\n                  <textarea\n                    value={editingAccount.description || ''}\n                    onChange={(e) => setEditingAccount({...editingAccount, description: e.target.value})}\n                    className=\"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                    rows={3}\n                  />\n                </div>\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"editAllowPosting\"\n                    checked={editingAccount.allowPosting}\n                    onChange={(e) => setEditingAccount({...editingAccount, allowPosting: e.target.checked})}\n                    className=\"mr-2\"\n                  />\n                  <label htmlFor=\"editAllowPosting\" className=\"text-sm text-gray-700\">\n                    Permitir movimientos contables\n                  </label>\n                </div>\n                <div className=\"flex items-center\">\n                  <input\n                    type=\"checkbox\"\n                    id=\"editIsActive\"\n                    checked={editingAccount.isActive}\n                    onChange={(e) => setEditingAccount({...editingAccount, isActive: e.target.checked})}\n                    className=\"mr-2\"\n                  />\n                  <label htmlFor=\"editIsActive\" className=\"text-sm text-gray-700\">\n                    Cuenta activa\n                  </label>\n                </div>\n              </div>\n              <div className=\"flex justify-end space-x-3 mt-6\">\n                <button\n                  onClick={() => setShowEditModal(false)}\n                  className=\"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 whitespace-nowrap\"\n                >\n                  Cancelar\n                </button>\n                <button\n                  onClick={handleEditAccount}\n                  className=\"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 whitespace-nowrap\"\n                >\n                  Guardar Cambios\n                </button>\n              </div>\n            </div>\n          </div>\n        )}\n      </div>\n    </DashboardLayout>\n  );\n}\n"],"names":["ChartAccountsPage","user","useAuth","accounts","setAccounts","useState","loading","setLoading","searchTerm","setSearchTerm","selectedAccountType","setSelectedAccountType","showAddModal","setShowAddModal","showEditModal","setShowEditModal","showImportModal","setShowImportModal","showFormatModal","setShowFormatModal","selectedFormat","setSelectedFormat","editingAccount","setEditingAccount","expandedAccounts","setExpandedAccounts","importProgress","setImportProgress","isImporting","setIsImporting","fileInputRef","useRef","newAccount","setNewAccount","useEffect","loadAccounts","data","chartAccountsService","error","importFormats","accountTypes","filteredAccounts","account","matchesSearch","matchesType","getAccountTypeColor","type","getAccountTypeName","getNormalBalance","getParentAccounts","calculateLevel","parentId","parent","acc","toggleExpanded","accountId","prev","id","getChildAccounts","handleFormatSelection","format","parseCSVContent","content","lines","importedData","i","line","columns","col","parseQuickBooksIIF","parts","accountType","mappedType","mapQuickBooksType","parseExcelData","file","text","parseXMLContent","code","name","parentCode","description","parseJSONContent","item","qbType","handleFileImport","event","fileExtension","csvContent","iifContent","xmlContent","jsonContent","processImportedData","codeToIdMap","createdAccount","downloadTemplate","formatId","template","filename","blob","url","a","handleAddAccount","handleEditAccount","handleDeleteAccount","downloadExcel","row","accountsByType","count","link","renderAccountRow","hasChildren","isExpanded","children","jsx","jsxs","child","topLevelAccounts","DashboardLayout","e"],"mappings":"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"}