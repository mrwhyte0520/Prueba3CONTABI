import{r as y,j as e,D as P,e as t,f as r,w as M}from"./index-CQa-GowG.js";const V=[{id:"company",name:"Información de la Empresa",description:"Configurar datos básicos de la empresa, logo y contacto",icon:"ri-building-line",href:"/settings/company"},{id:"accounting",name:"Configuración Contable",description:"Configurar períodos fiscales, monedas y políticas contables",icon:"ri-calculator-line",href:"/settings/accounting"},{id:"taxes",name:"Configuración de Impuestos",description:"Configurar tipos de impuestos, tasas y reglas fiscales",icon:"ri-percent-line",href:"/settings/taxes"},{id:"inventory",name:"Configuración de Inventario",description:"Configurar métodos de valuación, categorías y almacenes",icon:"ri-archive-line",href:"/settings/inventory"},{id:"payroll",name:"Configuración de Nómina",description:"Configurar conceptos de nómina, deducciones y beneficios",icon:"ri-money-dollar-circle-line",href:"/settings/payroll"},{id:"backup",name:"Respaldos y Seguridad",description:"Configurar respaldos automáticos y políticas de seguridad",icon:"ri-shield-check-line",href:"/settings/backup"}];function z(){const[v,N]=y.useState(""),[w,j]=y.useState(!1),[S,_]=y.useState(!1),[p,h]=y.useState(!1),[b,g]=y.useState(null),C=V.filter(a=>a.name.toLowerCase().includes(v.toLowerCase())||a.description.toLowerCase().includes(v.toLowerCase())),I=a=>{window.REACT_APP_NAVIGATE(a)},D=async()=>{h(!0),g(null);try{const[a,l,d,n,s,m,u,f]=await Promise.all([t.getCompanyInfo(),t.getAccountingSettings(),t.getTaxSettings(),t.getInventorySettings(),t.getPayrollSettings(),t.getTaxRates(),t.getWarehouses(),t.getPayrollConcepts()]),x=r.book_new();if(a){const o=[["Campo","Valor"],["Nombre de la Empresa",a.name||""],["RNC",a.rnc||""],["Dirección",a.address||""],["Teléfono",a.phone||""],["Email",a.email||""],["Sitio Web",a.website||""],["Sector",a.sector||""],["Tipo de Empresa",a.company_type||""]],c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Información Empresa")}if(l){const o=[["Campo","Valor"],["Inicio Año Fiscal",l.fiscal_year_start||""],["Fin Año Fiscal",l.fiscal_year_end||""],["Moneda por Defecto",l.default_currency||""],["Decimales",l.decimal_places||""],["Formato de Fecha",l.date_format||""],["Formato de Números",l.number_format||""],["Respaldo Automático",l.auto_backup?"Sí":"No"],["Frecuencia de Respaldo",l.backup_frequency||""],["Período de Retención",l.retention_period||""]],c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Config Contable")}if(d){const o=[["Campo","Valor"],["Tasa ITBIS (%)",d.itbis_rate||""],["Tasa ISR (%)",d.isr_rate||""],["Tasa Retención (%)",d.retention_rate||""],["Frecuencia Declaración",d.declaration_frequency||""],["Inicio Año Fiscal",d.fiscal_year_start||""],["Fin Año Fiscal",d.fiscal_year_end||""]],c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Config Impuestos")}if(n){const o=[["Campo","Valor"],["Método de Valuación",n.valuation_method||""],["Reorden Automático",n.auto_reorder?"Sí":"No"],["Rastrear Números de Serie",n.track_serial_numbers?"Sí":"No"],["Rastrear Fechas de Vencimiento",n.track_expiration_dates?"Sí":"No"],["Almacén por Defecto",n.default_warehouse||""]],c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Config Inventario")}if(s){const o=[["Campo","Valor"],["Frecuencia de Pago",s.pay_frequency||""],["Tasa Horas Extra",s.overtime_rate||""],["Tasa Seguro Social (%)",s.social_security_rate||""],["Tasa AFP (%)",s.afp_rate||""],["Tasa SFS (%)",s.sfs_rate||""],["Bono Navideño",s.christmas_bonus?"Sí":"No"],["Días de Vacaciones",s.vacation_days||""]],c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Config Nómina")}if(m&&m.length>0){const o=[["Nombre","Tipo","Tasa (%)","Descripción","Activo"]];m.forEach(i=>{o.push([i.name||"",i.type||"",i.rate||"",i.description||"",i.is_active?"Sí":"No"])});const c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Tasas Impuestos")}if(u&&u.length>0){const o=[["Nombre","Código","Dirección","Teléfono","Responsable","Activo"]];u.forEach(i=>{o.push([i.name||"",i.code||"",i.address||"",i.phone||"",i.manager||"",i.is_active?"Sí":"No"])});const c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Almacenes")}if(f&&f.length>0){const o=[["Nombre","Código","Tipo","Fórmula","Activo"]];f.forEach(i=>{o.push([i.name||"",i.code||"",i.type||"",i.formula||"",i.is_active?"Sí":"No"])});const c=r.aoa_to_sheet(o);r.book_append_sheet(x,c,"Conceptos Nómina")}const R=[["Campo","Valor"],["Fecha de Exportación",new Date().toLocaleString("es-DO")],["Sistema","Contabi RD"],["Versión","1.0"],["Usuario","Administrador"],["Descripción","Configuración completa del sistema contable"]],T=r.aoa_to_sheet(R);r.book_append_sheet(x,T,"Info Exportación");const F=`contabi-configuracion-${new Date().toISOString().split("T")[0]}.xlsx`;M(x,F),g({type:"success",text:"Configuración exportada exitosamente en formato Excel. El archivo se ha descargado."})}catch(a){console.error("Error exporting configuration:",a),g({type:"error",text:"Error al exportar la configuración. Inténtalo de nuevo."})}finally{h(!1)}},k=()=>{const a=document.createElement("input");a.type="file",a.accept=".json",a.onchange=async l=>{const d=l.target.files?.[0];if(d){h(!0),g(null);try{const n=await d.text(),s=JSON.parse(n);if(!s.exportInfo||!s.exportInfo.version)throw new Error("Archivo de configuración inválido o corrupto");if(s.exportInfo.systemName!=="Contabi RD")throw new Error("Este archivo no es compatible con Contabi RD");let m=0;if(s.companyInfo&&(await t.saveCompanyInfo(s.companyInfo),m++),s.accountingSettings&&(await t.saveAccountingSettings(s.accountingSettings),m++),s.taxSettings&&(await t.saveTaxSettings(s.taxSettings),m++),s.inventorySettings&&(await t.saveInventorySettings(s.inventorySettings),m++),s.payrollSettings&&(await t.savePayrollSettings(s.payrollSettings),m++),s.taxRates&&Array.isArray(s.taxRates))for(const u of s.taxRates)try{await t.createTaxRate(u)}catch(f){console.warn("Tax rate already exists or error creating:",f)}if(s.warehouses&&Array.isArray(s.warehouses))for(const u of s.warehouses)try{await t.createWarehouse(u)}catch(f){console.warn("Warehouse already exists or error creating:",f)}if(s.payrollConcepts&&Array.isArray(s.payrollConcepts))for(const u of s.payrollConcepts)try{await t.createPayrollConcept(u)}catch(f){console.warn("Payroll concept already exists or error creating:",f)}g({type:"success",text:`Configuración importada exitosamente. ${m} secciones actualizadas.`})}catch(n){console.error("Error importing configuration:",n);let s="Error al importar la configuración.";n instanceof SyntaxError?s="El archivo seleccionado no es un JSON válido.":n instanceof Error&&(s=n.message),g({type:"error",text:s})}finally{h(!1)}}},a.click()},A=async()=>{h(!0);try{const a={fiscal_year_start:"2024-01-01",fiscal_year_end:"2024-12-31",default_currency:"DOP",decimal_places:2,date_format:"DD/MM/YYYY",number_format:"1,234.56",auto_backup:!0,backup_frequency:"daily",retention_period:30},l={itbis_rate:18,isr_rate:27,retention_rate:10,declaration_frequency:"monthly",fiscal_year_start:"2024-01-01",fiscal_year_end:"2024-12-31"},d={valuation_method:"FIFO",auto_reorder:!1,track_serial_numbers:!1,track_expiration_dates:!1,default_warehouse:"Principal"},n={pay_frequency:"monthly",overtime_rate:1.5,social_security_rate:2.87,afp_rate:2.87,sfs_rate:3.04,christmas_bonus:!0,vacation_days:14};await Promise.all([t.saveAccountingSettings(a),t.saveTaxSettings(l),t.saveInventorySettings(d),t.savePayrollSettings(n)]),g({type:"success",text:"Configuración restablecida a valores por defecto de República Dominicana"}),_(!1)}catch(a){console.error("Error resetting configuration:",a),g({type:"error",text:"Error al restablecer la configuración"})}finally{h(!1)}},E=[{id:"1",section:"Información de la Empresa",action:"Actualización",user:"Admin",timestamp:new Date().toISOString(),details:"Actualizado nombre de la empresa y dirección"},{id:"2",section:"Configuración de Impuestos",action:"Modificación",user:"Contador",timestamp:new Date(Date.now()-864e5).toISOString(),details:"Modificada tasa de ITBIS de 18% a 18%"},{id:"3",section:"Gestión de Usuarios",action:"Creación",user:"Admin",timestamp:new Date(Date.now()-1728e5).toISOString(),details:"Creado nuevo usuario con rol de Contador"}];return y.useState(()=>{if(b){const a=setTimeout(()=>{g(null)},5e3);return()=>clearTimeout(a)}}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-6",children:[b&&e.jsx("div",{className:`p-4 rounded-lg ${b.type==="success"?"bg-green-50 text-green-700 border border-green-200":"bg-red-50 text-red-700 border border-red-200"}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("i",{className:`${b.type==="success"?"ri-check-circle-line":"ri-error-warning-line"} mr-2`}),b.text]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Configuración del Sistema"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Administra la configuración general de tu sistema contable"})]}),e.jsx("div",{className:"flex items-center space-x-3",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx("i",{className:"ri-search-line text-gray-400"})}),e.jsx("input",{type:"text",placeholder:"Buscar configuración...",value:v,onChange:a=>N(a.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:C.map(a=>e.jsx("div",{onClick:()=>I(a.href),className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer group",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center group-hover:bg-blue-200 transition-colors",children:e.jsx("i",{className:`${a.icon} text-blue-600 text-xl`})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.description}),e.jsxs("div",{className:"mt-3 flex items-center text-sm text-blue-600 group-hover:text-blue-700",children:[e.jsx("span",{children:"Configurar"}),e.jsx("i",{className:"ri-arrow-right-line ml-1"})]})]})]})},a.id))}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Acciones Rápidas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("button",{onClick:D,disabled:p,className:"flex items-center justify-center space-x-2 bg-green-50 text-green-700 px-4 py-3 rounded-lg hover:bg-green-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx("i",{className:`${p?"ri-loader-4-line animate-spin":"ri-download-line"}`}),e.jsx("span",{children:p?"Exportando...":"Exportar Configuración"})]}),e.jsxs("button",{onClick:k,disabled:p,className:"flex items-center justify-center space-x-2 bg-blue-50 text-blue-700 px-4 py-3 rounded-lg hover:bg-blue-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx("i",{className:`${p?"ri-loader-4-line animate-spin":"ri-upload-line"}`}),e.jsx("span",{children:p?"Importando...":"Importar Configuración"})]}),e.jsxs("button",{onClick:()=>_(!0),disabled:p,className:"flex items-center justify-center space-x-2 bg-orange-50 text-orange-700 px-4 py-3 rounded-lg hover:bg-orange-100 transition-colors disabled:opacity-50 disabled:cursor-not-allowed whitespace-nowrap",children:[e.jsx("i",{className:"ri-refresh-line"}),e.jsx("span",{children:"Restablecer Valores"})]}),e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center justify-center space-x-2 bg-purple-50 text-purple-700 px-4 py-3 rounded-lg hover:bg-purple-100 transition-colors whitespace-nowrap",children:[e.jsx("i",{className:"ri-history-line"}),e.jsx("span",{children:"Historial de Cambios"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Estado del Sistema"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Base de Datos"}),e.jsx("p",{className:"text-xs text-green-700",children:"Conectada y funcionando"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"Respaldos"}),e.jsx("p",{className:"text-xs text-green-700",children:"Último: Hoy 03:00 AM"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-900",children:"Actualizaciones"}),e.jsx("p",{className:"text-xs text-yellow-700",children:"1 actualización disponible"})]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full mx-4 max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Historial de Cambios"}),e.jsx("button",{onClick:()=>j(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("i",{className:"ri-close-line text-xl"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[60vh]",children:e.jsx("div",{className:"space-y-4",children:E.map(a=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:a.section}),e.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${a.action==="Creación"?"bg-green-100 text-green-800":a.action==="Actualización"?"bg-blue-100 text-blue-800":"bg-orange-100 text-orange-800"}`,children:a.action})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a.details}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Por: ",a.user]}),e.jsx("span",{children:new Date(a.timestamp).toLocaleString("es-DO")})]})]})})},a.id))})})]})}),S&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-full flex items-center justify-center",children:e.jsx("i",{className:"ri-alert-line text-orange-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Confirmar Restablecimiento"})]}),e.jsx("p",{className:"text-gray-600 mb-6",children:"¿Estás seguro de que deseas restablecer todas las configuraciones a sus valores por defecto de República Dominicana? Esta acción no se puede deshacer."}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>_(!1),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:A,disabled:p,className:"flex-1 px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Restableciendo...":"Restablecer"})]})]})})})]})})}export{z as default};
//# sourceMappingURL=page-BCqtfmOC.js.map
